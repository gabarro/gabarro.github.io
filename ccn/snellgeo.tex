\title{From Snell's law to Christoffel symbols}

The unfulfilled goal of this study is to take Snell's law of refraction
$$
\frac{\sin\theta_1}{c_1}=\frac{\sin\theta_2}{c_2}
$$
manipulate it somehow, and obtain the geodesic equations on a manifold
$$
\ddot q^i = \Gamma^i_{jk}\,\dot q^j\,\dot q^k
$$
So far, we have reached this goal only for some particular cases of Riemannian
metrics in the plane (either conformal, or anisotropic but varying only on the
horizontal direction).

Notice that both Snell's law and the geodesic equations describe the same
thing: the fastest trajectory on an inhomogeneous medium.  Thus, it is natural
that they are equivalent.

\section{Geodesic equations}

On this section we derive the geodesic equations on a manifold using the
direct method of the calculus of variations.  Notice that the rest of the
text is much larger than this section.  This is natural, because this section
uses advanced tools (variational calculus), while the rest of the text only
uses elementary tools.


On an~$n$-dimensional Riemannian manifold $(M,g)$, we define the length of a
curve~$q:[0,1]\to M$ by
$$
\mathrm{length}(q) := \int_0^1 \|\dot q(t)\|_g\mathrm{d} t
$$
where~$\|v\|_g$ denotes the norm of the vector~$v$ measured by the local
metric tensor~$g$.  In coordinates, and using Einstein's summation
convention, we have~$\|\dot q\|^2_g=g_{ij}\dot q^i\dot q^j$.  Notice that the
dependence of~$g$ on the position~$q$ is not explicit.  Writing the norm
explicitly in coordinates, we have
$$
\mathrm{length}(q) := \int_0^1
\sqrt{
%\left(
	\sum_{i=1}^n
	\sum_{j=1}^n
	g_{ij}\left(q^1(t),\ldots,q^n(t)\right)
	\,
	q^i(t)
	q^j(t)
%\right)^\frac{1}{2}
}
\ \mathrm{d} t
$$
Now, it is easy to see that the length is invariant to reparametrizations
$\mathrm{length}(q)=\mathrm{length}(q\circ h)$.  The curves that are local
minima of the length functional are called~\emph{geodesics}.  Now, the length
functional is a bit cumbersome to minimize directly due to the square root.
We work instead with the energy functional:
$$
\mathrm{energy}(q) := \frac{1}{2}\int_0^1 \|\dot q(t)\|^2_g\mathrm{d} t
$$
This functional is much easier to minimize (the Euler-Lagrange equations are
linear).  The curves of minimum energy turn out to be the geodesics
parametrized at constant speed.  This can be seen by applying the
Cauchy-Schwarz inequality to the functions~$\|\dot q\|$ and~$1$:
$$
\left(\int_0^1\|\dot q\|\right)^2\le2\int_0^1\|\dot q\|^2
$$
with equality if and only if the two functions are proportional~$\|\dot
q\|=c$.  Thus, if a curve~$q$ parametrized at constant speed minimzes the
energy then it also minimizes the length.

In general, to minimize an energy of the form~$\int L(q(t),\dot
q(t))\,\mathrm{d} t$ you have to find curves~$q$ that satisfy
the Euler-Lagrange equations
$$
\frac{\partial L}{\partial q^k}
-\frac{\mathrm{d}}{\mathrm{d} t}
\frac{\partial L}{\partial \dot q^k}
= 0
\qquad k=1,\ldots,n
$$
In our case, the Lagragian~$L$ is (using Einstein notation):
$$
L=
\tfrac{1}{2}
g_{ij}\dot q^i\dot q^j
$$
and we just have to compute each term of the Euler-Lagrange equations.
The computation follows (using commas to denote partial derivatives):
$$
\frac{\partial L}{\partial q^k}
=
\tfrac{1}{2}
g_{ij,k}\dot q^i\dot q^j
$$
$$
\frac{\partial L}{\partial \dot q^k}
=
\tfrac{1}{2}\left(g_{ik}+g_{ki}\right)\dot q^i
%g_{ik}\dot q^i %incorrect!
$$
$$
\frac{\mathrm{d}}{\mathrm{d} t}
\frac{\partial L}{\partial \dot q^k}
=
g_{ik}\ddot q^i
+
%\tfrac{1}{2}\left(g_{ik,j}\dot q^j+g_{ki,j}\dot q^j\right)\dot q^i
\tfrac{1}{2}\left(g_{ik,j}+g_{kj,i}\right)\dot q^i\dot q^j
$$
so the Euler-Lagrange equations are:
%$$
%\tfrac{1}{2}
%g_{ij,k}\dot q^i\dot q^j
%=
%g_{ik}\ddot q^i
%+
%\tfrac{1}{2}\left(g_{ik,j}+g_{kj,i}\right)\dot q^i\dot q^j
%$$
%this can be arranged thus
$$
g_{ik}\ddot q^i
=
\tfrac{1}{2}
\left(
g_{ij,k}-g_{ik,j}-g_{kj,i}
\right)
\dot q^i\dot q^j
$$
and using the inverse of the matrix~$g_{ij}$, denoted as~$g^{ij}$:
$$
\ddot q^k
=
\tfrac{1}{2}
g^{ik}
\left(
g_{ij,k}-g_{ik,j}-g_{kj,i}
\right)
\dot q^i\dot q^j
$$
This last equation is a system of second order quasilinear equations whose
coefficients depend on the metric.  The geodesics are precisely the solutions
of this system.  It has the form
$$
\ddot q^k = \Gamma^k_{ij}\dot q^i\dot q^j
\qquad k=1,\ldots, n
$$
and the coefficients~$\Gamma^k_{ij}$ are called the~\emph{Christoffel symbols}:
$$
\Gamma^k_{ij} =
\tfrac{1}{2}
g^{ik}
\left(
g_{ij,k}-g_{ik,j}-g_{kj,i}
\right)
$$
The solutions of this system of equations are the geodesics of the manifold.

We can already extract some geometric conclusions from the form of the
Christoffel symbols.  Notice that they are homogeneous on the derivatives of
the metric.  This implies that, if the metric is constant (even if it is
anisotropic), all the Christoffel symbols vanish and the equations of
geodesics are~$\ddot q=0$, whose solutions are straight lines traversed at
constant speed.

The computation given above using index juggling is very concise but a bit
scary, depending on your mood.  For comparison, we give below the same
computation for the case of a two-dimensional manifold whose first
fundamental form
is~$g=\left(\begin{smallmatrix}E & F \\ F & G\end{smallmatrix}\right)$.  The
Lagrangian of the energy functional is
$$
L=
\tfrac{1}{2}E\dot x^2+F\dot x\dot y+\tfrac{1}{2}G\dot y^2
$$
and then
$$
\frac{\partial L}{\partial x}
=
\tfrac{1}{2}E_x\dot x^2+F_x\dot x\dot y+\tfrac{1}{2}G_x\dot y^2
$$
$$
\frac{\partial L}{\partial y}
=
\tfrac{1}{2}E_y\dot x^2+F_y\dot x\dot y+\tfrac{1}{2}G_y\dot y^2
$$
$$
\frac{\partial L}{\partial \dot x}
=
E\dot x+F\dot y
$$
$$
\frac{\partial L}{\partial \dot y}
=
F\dot x+G\dot y
$$
$$
\frac{\mathrm{d}}{\mathrm{d} t}
\frac{\partial L}{\partial \dot x}
=
E\ddot x
+\left(E_x\dot x+E_y\dot y\right)\dot x
+F\ddot y
+\left(F_x\dot x+F_y\dot y\right)\dot y
$$
$$
\frac{\mathrm{d}}{\mathrm{d} t}
\frac{\partial L}{\partial \dot y}
=
F\ddot x
+\left(F_x\dot x+F_y\dot y\right)\dot x
+G\ddot y
+\left(G_x\dot x+G_y\dot y\right)\dot y
$$
which we can replace into the Euler-Lagrange equations to obtain
$$
\begin{cases}
	E\ddot x+F\ddot y &=
	\left(-\tfrac{1}{2}E_x\right)\dot x^2
	+E_y\dot x\dot y
	+\left(\tfrac{1}{2}G_x-F_y\right)\dot y^2
	\\
	F\ddot x+G\ddot y &=
	\left(\tfrac{1}{2}E_y-F_x\right)\dot x^2
	+G_x\dot x\dot y
	+
	\left(-\tfrac{1}{2}G_y\right)\dot y^2
\end{cases}
$$




\section{Four proofs of Snell's law}

On this section we state Snell's law of refraction and give four different
proofs of it.

Snell's law describes the fastest path that a sexy lifeguard has to take to
save me when I'm drowning.  Notice that the fastest path is not necessarily the shortest path.

\subsection{Proof of Snell's law based on a minimiazation problem}

\subsection{Proof of Snell's law based translational symmetry}

\subsection{Proof of Snell's law for waves}

\subsection{Proof of Snell's law using Feynman integrals}


\section{Continuously varying Snell's law}

\section{Anisotropic Snell's law}

\section{Isotropic Snell's law on a conformal surface}

\section{The general case: Snell's law on a Riemannian manifold}

This is the missing section.  I do not know how to do it, but it seems to me
that this should be a combination of the two previous sections.

\section{Computational examples}

\section{Appendix 1: geodesic interpretation of several common ODE}

\section{Appendix 2: Finsler Snell's law}


% vim:set tw=77 filetype=tex spell spelllang=en:
